!function(e){function t(t){for(var i,o,a=t[0],c=t[1],l=t[2],d=0,h=[];d<a.length;d++)o=a[d],r[o]&&h.push(r[o][0]),r[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);for(u&&u(t);h.length;)h.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],i=!0,a=1;a<n.length;a++){var c=n[a];0!==r[c]&&(i=!1)}i&&(s.splice(t--,1),e=o(o.s=n[0]))}return e}var i={},r={0:0},s=[];function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="./";var a=window.webpackJsonp=window.webpackJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;s.push([1406,1]),n()}({1406:function(e,t,n){e.exports=n(1407)},1407:function(e,t,n){"use strict";n.r(t);var i,r,s,o,a,c=n(25);!function(e){e.GAMEOBJECT_OUT="gameobjectout",e.GAMEOBJECT_DOWN="gameobjectdown",e.GAMEOBJECT_OVER="gameobjectover",e.CHANGE_DATA="changedata"}(i||(i={})),function(e){e.CLICKED="clicked",e.DOUBLE_CLICKED="doubleClicked",e.HOVER_IN="hoverIn",e.HOVER_OUT="hoverOut",e.ADJACENCY_ON="adjacencyOn",e.ADJACENCY_OFF="adjacencyOff",e.REFRESH_STATE="updateState",e.POINTER_LEFT="pointer_left",e.POINTER_RIGHT="pointer_right"}(r||(r={})),function(e){e.MINE_REVEALED="mine_uncovered",e.CELL_UNCOVERED="cell_uncovered",e.CELL_FLAGGED="cell_flagged",e.CELL_UNFLAGGED="cell_unflagged"}(s||(s={})),function(e){e.COVERED="covered",e.FLAGGED="flagged",e.HOVER="hover",e.ADJACENT="adjacent",e.MINED="mine"}(o||(o={})),function(e){e.UNCOVERED_1="UNCOVERED_1",e.UNCOVERED_2="UNCOVERED_2",e.UNCOVERED_LONG_1="UNCOVERED_LONG_1",e.MINE_UNCOVER_1="MINE_UNCOVER_1",e.FLAGGED_1="FLAGGED_1",e.FLAGGED_2="FLAGGED_2",e.FLAGGED_3="FLAGGED_3",e.UNFLAG_1="UNFLAG_1",e.UNFLAG_2="UNFLAG_2"}(a||(a={}));var l,u,d=n(516),h=n.n(d),f=(l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});!function(e){e.UNCOVERED="uncovered",e.FLAGGED="flagged",e.UNFLAGGED="unflagged",e.MINE_UNCOVERED="mine_uncovered"}(u||(u={}));var p=function(e){function t(t){var n=e.call(this)||this;return n.coordinate=t.coordinate,n.mined=t.isMined,n.adjacentMines=t.neighbouringMines,n.flagged=!1,n.covered=!0,n.highlight=!1,n}return f(t,e),t.prototype.toggleFlag=function(){return this.flagged?this.emit(u.UNFLAGGED):this.emit(u.FLAGGED),this.flagged=!this.flagged,this.flagged},t.prototype.isEmpty=function(){return!this.flagged&&0===this.adjacentMines&&!this.mined},t.prototype.getAdjacentCells=function(){return E.getAdjacentCoords(this.coordinate).map(function(e){return E.getCell(e)})},t.prototype.getAdjacentCoveredCells=function(){return this.getAdjacentCells().filter(function(e){return!e.flagged&&e.covered})},t.prototype.uncover=function(){if(this.flagged)this.toggleFlag();else if(this.isEmpty()&&this.covered){this.covered=!1,this.emit(this.mined?u.MINE_UNCOVERED:u.UNCOVERED),this.getAdjacentCoveredCells().forEach(function(e){e.uncover()})}else this.covered=!1,this.emit(this.mined?u.MINE_UNCOVERED:u.UNCOVERED)},t.prototype.addEventListner=function(e,t){this.addListener(e,t)},t}(h.a.EventEmitter),E=function(){function e(t,n){void 0===n&&(n={}),e.nRows=t,e.nColumns=t,e.nMines=n.mines||Math.floor(t/2+Math.pow(t,1.2));var i=new Array(e.nColumns).fill(void 0).map(function(t,n){return function(t){return new Array(e.nRows).fill(void 0).map(function(e,n){return{coordinate:[t,n],isMined:!1,neighbouringMines:0}})}(n)}),r=e.nMines;do{for(var s=0;s<e.nRows;s++)for(var o=0;o<e.nColumns;o++)10===e.getRandomIntInclusive(1,10)&&!i[s][o].isMined&&r>0&&(i[s][o].isMined=!0,r--)}while(r>0);for(s=0;s<e.nRows;s++)for(o=0;o<e.nColumns;o++){var a=e.getAdjacentCoords([s,o]).map(function(e){var t=e[0],n=e[1];return i[t][n].isMined?1:0}).reduce(function(e,t){return e+t},0);i[s][o].neighbouringMines=a}e.Cells=i.map(function(e){return e.map(function(e){return new p(e)})})}return e.getRandomIntInclusive=function(e,t){var n=Math.ceil(e),i=Math.floor(t);return Math.floor(Math.random()*(i-n+1))+e},e.getAdjacentCoords=function(t){return[[t[0]-1,t[1]-1],[t[0]-1,t[1]],[t[0]-1,t[1]+1],[t[0],t[1]-1],[t[0],t[1]+1],[t[0]+1,t[1]-1],[t[0]+1,t[1]],[t[0]+1,t[1]+1]].filter(function(t){return t.every(function(e){return e>=0})&&t[0]<=e.nRows-1&&t[1]<=e.nColumns-1})},e.getCell=function(t){return e.Cells[t[0]][t[1]]},e.uncoverRemainingMines=function(){var t=e.Cells.flat(1).filter(function(e){return e.mined});return t.map(function(e){return e.uncover()}),t},e}();class v{constructor(e){v._scene=e,e.load.path="/assets/images/",e.load.atlasXML("Tiles","tiles.png","tiles.xml"),e.load.path="/assets/audio/",e.load.audio(a.UNCOVERED_1,"uncover_1.mp3"),e.load.audio(a.UNCOVERED_2,"uncover_2.mp3"),e.load.audio(a.UNCOVERED_LONG_1,"uncover_long_1.mp3"),e.load.audio(a.MINE_UNCOVER_1,"mine_uncover_1.mp3"),e.load.audio(a.FLAGGED_1,"flagged_1.mp3"),e.load.audio(a.FLAGGED_2,"flagged_2.mp3"),e.load.audio(a.FLAGGED_3,"flagged_3.mp3"),e.load.audio(a.UNFLAG_1,"unflag_1.mp3"),e.load.audio(a.UNFLAG_2,"unflag_2.mp3")}static addSounds(){v.Sounds.set(a.UNCOVERED_1,this._scene.sound.add(a.UNCOVERED_1)),v.Sounds.set(a.UNCOVERED_2,this._scene.sound.add(a.UNCOVERED_2)),v.Sounds.set(a.UNCOVERED_LONG_1,this._scene.sound.add(a.UNCOVERED_LONG_1)),v.Sounds.set(a.MINE_UNCOVER_1,this._scene.sound.add(a.MINE_UNCOVER_1)),v.Sounds.set(a.FLAGGED_1,this._scene.sound.add(a.FLAGGED_1)),v.Sounds.set(a.FLAGGED_2,this._scene.sound.add(a.FLAGGED_2)),v.Sounds.set(a.FLAGGED_3,this._scene.sound.add(a.FLAGGED_3)),v.Sounds.set(a.UNFLAG_1,this._scene.sound.add(a.UNFLAG_1)),v.Sounds.set(a.UNFLAG_2,this._scene.sound.add(a.UNFLAG_2))}}v.Sounds=new Map([]);const m=(e,t)=>e.every((e,n)=>e===t[n]);class _ extends c.GameObjects.Sprite{constructor(e,t,n){super(e,t.x,t.y,"Tiles",o.COVERED),this.isHover=!1,this.setInteractive(),this.on(r.CLICKED,this.clickEventHandler),this.on(r.DOUBLE_CLICKED,this.doubleClickEventHandler),this.on(r.HOVER_IN,this.hoverInEventHandler),this.on(r.HOVER_OUT,this.hoverOutEventHandler),this.cellData=n.cellObj,this.cellData.addEventListner(u.FLAGGED,()=>{e.events.emit(s.CELL_FLAGGED)}),this.cellData.addEventListner(u.UNCOVERED,()=>{e.events.emit(s.CELL_UNCOVERED)}),this.cellData.addEventListner(u.UNFLAGGED,()=>{e.events.emit(s.CELL_UNFLAGGED)}),this.cellData.addEventListner(u.MINE_UNCOVERED,()=>{e.events.emit(s.MINE_REVEALED)})}refreshState(){this.isAdajcentToHovered()?this.setTexture("Tiles",o.ADJACENT):this.isHover&&!this.cellData.flagged?this.setTexture("Tiles",o.HOVER):this.cellData.covered?this.cellData.flagged?this.setTexture("Tiles",o.FLAGGED):this.setTexture("Tiles",o.COVERED):this.cellData.mined?this.setTexture("Tiles",o.MINED):this.setTexture("Tiles",this.cellData.adjacentMines.toString())}clickEventHandler(e,t){switch(this.isHover=!1,t){case r.POINTER_LEFT:this.cellData.uncover();break;case r.POINTER_RIGHT:this.cellData.toggleFlag()}}doubleClickEventHandler(e,t){switch(t){case r.POINTER_LEFT:_.ADJACENCY_COORDS=[],this.cellData.getAdjacentCoveredCells().map(e=>e.uncover())}}hoverInEventHandler(){if(this.cellData.covered)this.isHover=!0,_.ADJACENCY_COORDS=[];else{const e=this.cellData.getAdjacentCoveredCells().map(e=>e.coordinate);_.ADJACENCY_COORDS=e}}hoverOutEventHandler(){this.cellData.covered&&(this.isHover=!1)}isAdajcentToHovered(){return _.ADJACENCY_COORDS.some(e=>m(e,this.cellData.coordinate))}}_.ADJACENCY_COORDS=[];const g={color:"#333333",fontFamily:"Roboto Condensed",fontSize:"24px"};class C extends c.GameObjects.Container{constructor(e,t){super(e,t.x,t.y),this.counterStrInit=this.scene.scene.get("GridScene").data.values.flagsRemaining.toString(),this.iconImg=new c.GameObjects.Image(e,t.x,t.y,"Tiles",o.FLAGGED),this.iconImg.setScale(.7,.7),this.setSize(60,60),this.counterDisplay=new c.GameObjects.Text(e,t.x-3,t.y-3,this.counterStrInit,g),this.add([this.iconImg,this.counterDisplay]),this.scene.scene.get("GridScene").data.events.on("changedata-flagsRemaining",(e,t,n,i)=>{this.counterDisplay.setText(n.toString())})}}class O extends c.GameObjects.Container{constructor(e,t){super(e,t.x,t.y),this.currentTimeAbs=0,this.currentTimeMMSS={m:"00",s:"00"},this.tickEvent=e.time.addEvent({delay:1e3,loop:!0,callback:this.incrementTime,callbackScope:this}),this.clockDisplay=new c.GameObjects.Text(e,t.x,t.y,`${this.currentTimeMMSS.m}:${this.currentTimeMMSS.s}`,g),this.add([this.clockDisplay])}incrementTime(){this.currentTimeAbs+=1,this.currentTimeMMSS.m=Math.floor(this.currentTimeAbs/60).toString().padStart(2,"0"),this.currentTimeMMSS.s=(this.currentTimeAbs%60).toString().padStart(2,"0"),this.clockDisplay.setText(`${this.currentTimeMMSS.m}:${this.currentTimeMMSS.s}`)}pauseTimer(){this.tickEvent.paused=!0}resumeTimer(){this.tickEvent.paused=!0}}class y extends c.Scene{constructor(){super({key:"Toolbar"})}create(){this.flagCounter=new C(this,{x:30,y:15}),this.gameTimer=new O(this,{x:50,y:8}),this.add.existing(this.flagCounter),this.add.existing(this.gameTimer),this.scene.get("GridScene").data.events.on("changedata-isGameOver",(e,t,n,i)=>{n||this.gameTimer.pauseTimer()})}}const L={type:Phaser.AUTO,width:600,height:660,parent:"main",scene:[class extends c.Scene{constructor(){super({key:"GridScene"}),this.cellObjs=[],this.lClicks=0,this.doubleClickDelay=170}init(e){new E(e.rows),this.mines=E.nMines,this.params=e}preload(){new v(this)}create(){this.data.set("flagsRemaining",this.mines),this.data.set("timeElapsed",0),this.data.set("isGameOver",!1),this.scene.add("Toolbar",y,!0),v.addSounds(),this.cellObjs=new Array(E.nRows).fill(void 0).map((e,t)=>new Array(E.nRows).fill(void 0).map((e,n)=>{const i={x:n*this.params.cellWidth+this.params.cellWidth/2,y:t*this.params.cellWidth+this.params.cellWidth/2+60};return this.add.existing(new _(this,i,{cellObj:E.getCell([t,n])}))})).flat(),this.input.mouse.disableContextMenu();const e=(e,t,n)=>{1==this.lClicks?t.emit(r.CLICKED,e,n):t.emit(r.DOUBLE_CLICKED,e,n),this.lClicks=0},t=()=>{console.log("game over"),E.uncoverRemainingMines(),this.cellObjs.forEach(e=>e.disableInteractive()),this.data.values.isGameOver=!0};this.input.on(i.GAMEOBJECT_DOWN,(t,n)=>{const i=t.rightButtonDown()?r.POINTER_RIGHT:r.POINTER_LEFT;this.lClicks++,this.time.delayedCall(this.doubleClickDelay,e,[t,n,i],this)}),this.input.on(i.GAMEOBJECT_OVER,(e,t)=>{t.emit(r.HOVER_IN,e)}),this.input.on(i.GAMEOBJECT_OUT,(e,t)=>{t.emit(r.HOVER_OUT,e)}),this.events.once(s.MINE_REVEALED,()=>{v.Sounds.get(a.MINE_UNCOVER_1).play(),t()}),this.events.on(s.CELL_FLAGGED,()=>{v.Sounds.get(a.FLAGGED_2).play(),this.data.values.flagsRemaining-=1}),this.events.on(s.CELL_UNFLAGGED,()=>{v.Sounds.get(a.UNFLAG_1).play(),this.data.values.flagsRemaining+=1}),this.events.on(s.CELL_UNCOVERED,()=>{v.Sounds.get(a.UNCOVERED_1).play()})}update(){this.cellObjs.forEach(e=>e.refreshState())}}],scale:{mode:c.Scale.FIT,autoCenter:c.Scale.CENTER_BOTH},audio:{disableWebAudio:!0},backgroundColor:"#FFFFFF"};class D extends c.Game{constructor(e){super(e)}}const G={rows:10,cellWidth:60};window.onload=()=>{new D(L).scene.start("GridScene",G)}},516:function(e,t,n){"use strict";var i,r="object"==typeof Reflect?Reflect:null,s=r&&"function"==typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function u(e,t,n,i){var r,s,o,a;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]),void 0===o)o=s[t]=n,++e._eventsCount;else if("function"==typeof o?o=s[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(r=l(e))>0&&o.length>r&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,a=c,console&&console.warn&&console.warn(a)}return e}function d(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,s(this.listener,this.target,e))}.bind(i);return r.listener=n,i.wrapFn=r,r}function h(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):p(r,r.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=r[e];if(void 0===c)return!1;if("function"==typeof c)s(c,this,t);else{var l=c.length,u=p(c,l);for(n=0;n<l;++n)s(u[n],this,t)}return!0},a.prototype.addListener=function(e,t){return u(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return u(this,e,t,!0)},a.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,d(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,d(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,i,r,s,o;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){o=n[s].listener,r=s;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,s=Object.keys(n);for(i=0;i<s.length;++i)"removeListener"!==(r=s[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return h(this,e,!0)},a.prototype.rawListeners=function(e){return h(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},a.prototype.listenerCount=f,a.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}}});